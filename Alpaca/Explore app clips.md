#Explore app clip

앱 클립은 iOS 14부터 제공되는 기능으로 사용자가 앱을 경험하는 새로운 방법이다.

## App Clip?

앱 클립이 무엇인지 이해하기 위해서 세 가지 컨셉으로 소개한다.

- 앱
  - 앱 클립은 앱의 추가적인 기능이기 때문에 앱 클립을 시작하기 전에는 앱이 필요하다.
- 앱 클립 경험
  - 앱 클립 경험은 iOS 14 이상의 기기에서 특정 URL이 웹 브라우저가 아닌 앱 클립에서 처리하도록 하는 것이다.
- 앱 클립 자체
  - 앱을 설치하지 않고도 앱이 제공하는 것중 일부를 사용자가 경험하게 할 수 있게 함.

### App clip experiences

앱 클립 경험에 대해서 좀 더 자세히 보면,

- 앱에 들어가는 새로운 진입점
- App Store Connect에 등록된 URL로 일어날 수 있음
- 사용자의 액션이나 Siri Suggestion로 나타남
  - 이미 등록한 URL을 담고 있는 NFG 태그, QR 코드, 사파리나 메시지의 링크 등 소스가 어디든 상관없이 URL을 통해 앱 클립으로 연결됨.
  - 또한 App Clip을 경험하게 하는 Apple이 디자인한 App Clip code는 추후에 나올 예정

<img src="https://user-images.githubusercontent.com/22453984/97154491-47716580-17b7-11eb-9323-ad4d6833506f.png" alt="스크린샷 2020-10-26 오후 6 15 49" style="zoom:33%;" />



### App Clip

앱 클립은 기존 Extension과 같이 Xcode에서 새로운 앱 타겟을 생성하는 것이다.

- 단독으로 동작하는 앱으로서 기존 앱에서 필요한 코드, 자원을 사용
- 앱 리뷰를 통해 앱과 함께 같이 심사를 받음
- 앱과 앱 클립이 한 번 앱스토어 등록이 되면 서로 배타적으로 다운로드가 되며 앱이 없어도 앱 클립만 다운받는 것이 가능함.
  - 때문에 앱 클립과 앱의 경험을 같에 만드는 것이 중요하다. 왜냐하면 사용자는 앱 클립의 경험이 앱에서도 계속해서 이어지는 것을 기대하기 때문.

- 앱 클립은 Thinning 과정을 거친 뒤 10MB 이하여야 하며 이를 위해 꼭 필요한 것들만 포함되어야 함

<img src="https://user-images.githubusercontent.com/22453984/97155941-5fe27f80-17b9-11eb-87a8-75585094f0ac.png" alt="스크린샷 2020-10-26 오후 6 30 47" style="zoom:50%;" />

위와 같은 구조로 앱이 한 목표를 향해서 동작한다고 한다면, 앱 클립에서는 보다 간결하고 명확하게 목표를 향해 가도록 설계해야 한다.

먼저 앱 클립에서 강점을 발휘할 수 있는 기능만 남겨야 한다. 앱 클립은 사용자가 필요한 그 순간에 나타나 목표를 이루게 해주는 기능이기 때문에 프로필 창이나 디렉토리 리스트 같은 기능은 그 순간에 필요가 없을 것이다.

<img src="https://user-images.githubusercontent.com/22453984/97156380-f7e06900-17b9-11eb-9b12-220f16f65e93.png" alt="스크린샷 2020-10-26 오후 6 35 03" style="zoom:50%;" />

다음으로, 앱 클립을 동작시키는 URL을 제대로 설계해야 한다.

앱 클립에서는 일반 앱에서 존재하는 탭 바 같은 네비게이션 UI가 없기 때문에 각 방향에 해당하는 URL을 설계함으로써 바로 목표로 향할 수 있도록 해야 한다. 예를 들어 가게에서 주문을 한다고 하면 그 가게가 어디의 가게인지 특정할 수 있도록 URL에 해당 정보를 포함하여야 사용자가 목표를 완수할 수 있을 것이다. 앱에서는 주문하려는 가게가 어디인지 선택할 수 있는 UI를 보여줌으로서 해결할 수 있는 문제이지만 앱 클립은 그렇지 않기 때문이다.

<img src="https://user-images.githubusercontent.com/22453984/97156854-a2f12280-17ba-11eb-9704-e3025fcf6357.png" alt="스크린샷 2020-10-26 오후 6 39 50" style="zoom:33%;" />

마지막으로 앱 클립을 잘 설계하면 많은 기능들을 앱 클립에서 수행할 수 있다. 그러나 중요한 것은 한 번에 하나의 기능만을 수행해야 한다는 것을 명심하는 것이다.

## Tech Overview

앱 클립에서는 기존 앱과 같이 많은 부분을 동일하게 사용이 가능하다.

다만, 사용자의 개인 정보를 다루는 API에 대해서는 제한이 있기 때문에 해당 API의 가이드라인을 따라야 한다.

<img src="https://user-images.githubusercontent.com/22453984/97158146-645c6780-17bc-11eb-884a-8bb57e3b7cbe.png" alt="스크린샷 2020-10-26 오후 6 52 24" style="zoom:33%;" />

이러한 기술 관련하여 유의할 점은 다음과 같다.

- 시스템은 일정 비활동 기간이 지난 후 앱 클립과 데이터를 지운다.
  - 또한 앱 클립은 iOS 백업에 포함되지 않는다.
- 앱 클립에서 개인 정보에 접근하는 것은 앱에서 보다 제한된다. 때문에 해당 개인 정보를 얻어 어떠한 경험을 전달하고 싶다면 사용자에게 앱의 설치를 통해 모든 기능을 활용하게끔 유도해야 한다.
- 앱 클립은 사용자나 앱 클립 URL을 통해서만 시작된다.
  - 이 때문에 커스텀한 URL 스킴은 동작하지 않는다.

## Device States and Transitions

마지막으로 한 기기에서 앱과 앱 클립이 동작하는 예와 데이터 공유에 대해 설명한다.

처음 URL이 스캔되고 이를 처리할 앱이나 앱 클립이 없다면 앱 클립이 다운되어 이를 처리할 수 있게 시작된다. 이후 앱 클립이 열리지 않으면 시스템은 앱 클립과 이와 관련된 데이터를 모두 지운다. 때문에 앱 클립과 이에 속한 데이터는 캐쉬와 같은 임시 데이터로써 다뤄야 한다.

<img src="https://user-images.githubusercontent.com/22453984/97158963-81456a80-17bd-11eb-82ce-b3306c3674de.png" alt="스크린샷 2020-10-26 오후 7 00 22" style="zoom:33%;" />

반면, 앱 클립이 반복적으로 쓰일 경우에는 시스템은 앱 클립의 존속 시간을 연장시켜 두어 자동으로 삭제되지 않게끔 한다.

만약 사용자가 앱 클립을 사용하다가 앱을 설치하는 경우에는 앱 클립에서 얻은 개인정보 권한은 자동으로 넘어가게 된다. 그리고 앱 클립과 관련 데이터를 삭제하지만 Group Container에 저장된 데이터를 앱이 가져갈 수 있도록 기회를 준다. 이 때 데이터를 이동시켜 그대로 사용하면 된다.

### App clip에 적합한 기술들

- Apple Pay: 간단하고 안전한 결제
- Notifications: 시간에 맞는 알림을 주고 싶을 때
- SwiftUI: 빠른 UI 구성
- SKOverlay: 앱을 다운받게 유도할 때 사용
- ASAuthorizationController: 로그인이나 회원가입 시